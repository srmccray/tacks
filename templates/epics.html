{% extends "base.html" %}

{% block title %}Epics — Tacks{% endblock %}

{% block content %}
<div id="content-area"
     hx-get="/epics"
     hx-trigger="every 2s [document.visibilityState === 'visible']"
     hx-target="this"
     hx-select="#content-area"
     aria-live="polite"
     aria-atomic="false">

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Title</th>
      <th>Status</th>
      <th>Progress</th>
    </tr>
  </thead>
  <tbody>
    {% if epics.is_empty() %}
    <tr>
      <td colspan="4" style="text-align:center;color:var(--pico-muted-color);padding:2rem 0">No epics yet</td>
    </tr>
    {% else %}
    {% for ep in epics %}
    <tr>
      <td><a href="/epics/{{ ep.task.id }}">{{ ep.task.id }}</a></td>
      <td>{{ ep.task.title }}</td>
      <td><span class="badge status-{{ ep.task.status }}">
        {%- if ep.task.status == crate::models::Status::Open -%}○ Open
        {%- else if ep.task.status == crate::models::Status::InProgress -%}◐ In Progress
        {%- else if ep.task.status == crate::models::Status::Done -%}✓ Done
        {%- else -%}⊘ Blocked{%- endif -%}
      </span></td>
      <td>{{ ep.children_done }}/{{ ep.children_total }}</td>
    </tr>
    {% endfor %}
    {% endif %}
  </tbody>
</table>
</div>
{% endblock %}
